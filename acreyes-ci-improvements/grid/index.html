
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://acreyes.github.io/kamayan/acreyes-ci-improvements/grid/">
      
      
        <link rel="prev" href="../driver/">
      
      
        <link rel="next" href="../dispatcher/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Grid - Kamayan</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#grid-unit" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Kamayan" class="md-header__button md-logo" aria-label="Kamayan" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kamayan
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Grid
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/acreyes/kamayan" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Kamayan" class="md-nav__button md-logo" aria-label="Kamayan" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Kamayan
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/acreyes/kamayan" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Infrastructure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Infrastructure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kamayan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kamayan
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../driver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Driver
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Grid
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Grid
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fields" class="md-nav__link">
    <span class="md-ellipsis">
      Fields
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packs" class="md-nav__link">
    <span class="md-ellipsis">
      Packs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#indexers-stencils" class="md-nav__link">
    <span class="md-ellipsis">
      Indexers &amp; Stencils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dispatcher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dispatcher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../type_list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TypeList
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Physics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Physics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../physics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Physics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hydro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hydro Unit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Equation Of State Unit
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fields" class="md-nav__link">
    <span class="md-ellipsis">
      Fields
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packs" class="md-nav__link">
    <span class="md-ellipsis">
      Packs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#indexers-stencils" class="md-nav__link">
    <span class="md-ellipsis">
      Indexers &amp; Stencils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="grid-unit">Grid Unit</h1>
<p><img alt="" src="../assets/grid_initialization.svg" /></p>
<p>Kamayan is built on parthenon's grid, which can support uniform, static
and adaptively refined meshes as a runtime option. The domain is initialized
as a uniform grid of <code>nx1</code>x<code>nx2</code>x<code>nx3</code> cells. These can then be
partitioned onto an initial grid of <code>MeshBlocks</code>, which can be further
refined based on various conditions. See <a href="#parameters">Parameters</a> for more 
details on the runtime parameters that control this behavior.</p>
<h2 id="fields">Fields</h2>
<p>Kamayan strongly prefers to reference field data stored on the <code>MeshBlock</code>s through
the type based interface. Fields are associated with a <code>struct</code>, and instantiations
of that type can be used to reference a desired element of that field if it 
is declared with some tensor shape. Kamayan exports all possible fields in
<code>kamayan/fields.hpp</code>, but which fields have been registered to the simulation
will depend on the configuration of the various units. Here fields are declared
with the <code>VARIABLE</code> macro, which takes in the type name in all capital letters,
which also serves as the string label associated with the field, and optionally
a list of <code>int</code>s that will become the tensor shape of the field when registered
with the <code>kamayan::AddField[s]</code> interfaces.</p>
<div class="highlight"><span class="filename">kamayan/fields.hpp:cons</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1">// conserved variables</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">VARIABLE</span><span class="p">(</span><span class="n">DENS</span><span class="p">);</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">VARIABLE</span><span class="p">(</span><span class="n">MOMENTUM</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w">  </span><span class="c1">// will register with shape=std::vector&lt;int&gt;{3}</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">VARIABLE</span><span class="p">(</span><span class="n">ENER</span><span class="p">);</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">VARIABLE</span><span class="p">(</span><span class="n">MAG</span><span class="p">);</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>KamayanUnit</code>s will register fields through the <code>Initialize</code> callback interface
that returns a <code>StateDescriptor</code>.</p>
</div>
<h2 id="packs">Packs</h2>
<p>Field data can be accessed through the <a href="https://parthenon-hpc-lab.github.io/parthenon/develop/src/sparse_packs.html#building-and-using-a-sparsepack"><code>SparsePack</code>s</a>
provided by parthenon that will pack variables by type into a single data structure
that can be used to index into cell level data on <code>MeshBlock</code>s and <code>MeshData</code> 
partitions. Kamayan provides an interface to directly get these packs, either
directly through listing explicitly the desired variables or by passing a 
<code>TypeList</code> of the variable structs you wish to access.</p>
<div class="highlight"><span class="filename">problems/isentropic_vortex.cpp:pack<br>physics/hydro/hydro_add_flux_tasks.cpp:pack</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1">// explicitly specify the fields we want</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">pack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grid</span><span class="o">::</span><span class="n">GetPack</span><span class="o">&lt;</span><span class="n">DENS</span><span class="p">,</span><span class="w"> </span><span class="n">VELOCITY</span><span class="p">,</span><span class="w"> </span><span class="n">PRES</span><span class="o">&gt;</span><span class="p">(</span><span class="n">mb</span><span class="p">);</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1">// packing with a decl&#39;ed `TypeList` from the HydroTraits</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">pack_recon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grid</span><span class="o">::</span><span class="n">GetPack</span><span class="p">(</span><span class="n">reconstruct_vars</span><span class="p">(),</span><span class="w"> </span><span class="n">md</span><span class="p">);</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">pack_flux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grid</span><span class="o">::</span><span class="n">GetPack</span><span class="p">(</span><span class="n">conserved_vars</span><span class="p">(),</span><span class="w"> </span><span class="n">md</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">PDOpt</span><span class="o">::</span><span class="n">WithFluxes</span><span class="p">});</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Additional pack options can be specified. In this example the <code>PDOpt::WithFluxes</code>
option means that the associated fluxes if any for the packed variables will
also be accessible with the <code>pack_flux.flux</code> interface.</p>
</div>
<p>Packs can then be indexed by block, variable and (k,j,i) index</p>
<div class="highlight"><span class="filename">problems/isentropic_vortex.cpp:index</span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="w">        </span><span class="n">pack</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">DENS</span><span class="p">(),</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">(</span><span class="n">DENS</span><span class="p">());</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">        </span><span class="n">pack</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">PRES</span><span class="p">(),</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">(</span><span class="n">PRES</span><span class="p">());</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">        </span><span class="n">pack</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">VELOCITY</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">(</span><span class="n">VELOCITY</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">        </span><span class="n">pack</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">VELOCITY</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">(</span><span class="n">VELOCITY</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
</code></pre></div>
<h2 id="indexers-stencils">Indexers &amp; Stencils</h2>
<p>Often we don't need full access to all block, and cell indices of the pack. Rather
it is advantageous only worry about a relative offset along the dimensions of interest
for a particular function. Some examples are the conversion of primitive to 
conservative variables, which only cares about indexing into different fields at the
same cell, or the reconstruction of Riemann states, which need only to index
into the same field at neighboring zones along a one dimensional stencil. </p>
<p>Kamayan provides the <code>Indexer</code> and <code>Stencil</code> abstractions to wrap packs and
<code>Kokkos::View</code>s to do just that.</p>
<p><div class="highlight"><span class="filename">physics/hydro/primconsflux.cpp:make-idx</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="w">          </span><span class="k">auto</span><span class="w"> </span><span class="n">U</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MakePackIndexer</span><span class="p">(</span><span class="n">pack</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">          </span><span class="n">Prim2Cons</span><span class="o">&lt;</span><span class="n">hydro_traits</span><span class="o">&gt;</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="w"> </span><span class="n">U</span><span class="p">);</span>
</code></pre></div>
<div class="highlight"><span class="filename">physics/hydro/primconsflux.hpp:use-idx</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="w">  </span><span class="n">U</span><span class="p">(</span><span class="n">DENS</span><span class="p">())</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="n">DENS</span><span class="p">());</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="n">U</span><span class="p">(</span><span class="n">MOMENTUM</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="n">DENS</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="n">VELOCITY</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="n">U</span><span class="p">(</span><span class="n">MOMENTUM</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="n">DENS</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="n">VELOCITY</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span><span class="n">U</span><span class="p">(</span><span class="n">MOMENTUM</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="n">DENS</span><span class="p">())</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">V</span><span class="p">(</span><span class="n">VELOCITY</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
</code></pre></div></p>
<div class="highlight"><span class="filename">physics/hydro/hydro_add_flux_tasks.cpp:make-stncl</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="w">                </span><span class="k">auto</span><span class="w"> </span><span class="n">stencil</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">                    </span><span class="n">MakePackStencil1D</span><span class="o">&lt;</span><span class="n">Axis</span><span class="o">::</span><span class="n">IAXIS</span><span class="o">&gt;</span><span class="p">(</span><span class="n">pack_recon</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">                </span><span class="n">Reconstruct</span><span class="o">&lt;</span><span class="n">reconstruction_traits</span><span class="o">&gt;</span><span class="p">(</span><span class="n">stencil</span><span class="p">,</span><span class="w"> </span><span class="n">vM</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">vP</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">));</span>
</code></pre></div>
<div class="highlight"><span class="filename">physics/hydro/reconstruction.hpp:use-stncl</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">dvL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stencil</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">stencil</span><span class="p">(</span><span class="mi">-1</span><span class="p">);</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">dvR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stencil</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">stencil</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</code></pre></div>
<h2 id="parameters">Parameters</h2>
<table>
<thead>
<tr>
<th>Paramter</th>
<th>Type</th>
<th>Default</th>
<th>Allowed</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>&lt;parthenon/mesh&gt;</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ix1_bc</td>
<td>String</td>
<td>outflow</td>
<td>[ periodic,  outflow,  reflect,  user, ]</td>
<td>Inner boundary condition along x1.</td>
</tr>
<tr>
<td>ix2_bc</td>
<td>String</td>
<td>outflow</td>
<td>[ periodic,  outflow,  reflect,  user, ]</td>
<td>Inner boundary condition along x2.</td>
</tr>
<tr>
<td>ix3_bc</td>
<td>String</td>
<td>outflow</td>
<td>[ periodic,  outflow,  reflect,  user, ]</td>
<td>Inner boundary condition along x3.</td>
</tr>
<tr>
<td>nghost</td>
<td>Integer</td>
<td>3</td>
<td></td>
<td>Number of ghost zones to use on each block.</td>
</tr>
<tr>
<td>numlevel</td>
<td>Integer</td>
<td>1</td>
<td></td>
<td>Number of refinement levels.</td>
</tr>
<tr>
<td>nx1</td>
<td>Integer</td>
<td>32</td>
<td></td>
<td>Number of cells across the domain at level 0.</td>
</tr>
<tr>
<td>nx2</td>
<td>Integer</td>
<td>32</td>
<td></td>
<td>Number of cells across the domain at level 0. Set to 1 for 1D.</td>
</tr>
<tr>
<td>nx3</td>
<td>Integer</td>
<td>32</td>
<td></td>
<td>Number of cells across the domain at level 0. Set to 1 for 2D.</td>
</tr>
<tr>
<td>ox1_bc</td>
<td>String</td>
<td>outflow</td>
<td>[ periodic,  outflow,  reflect,  user, ]</td>
<td>Outer boundary condition along x1.</td>
</tr>
<tr>
<td>ox2_bc</td>
<td>String</td>
<td>outflow</td>
<td>[ periodic,  outflow,  reflect,  user, ]</td>
<td>Outer boundary condition along x2.</td>
</tr>
<tr>
<td>ox3_bc</td>
<td>String</td>
<td>outflow</td>
<td>[ periodic,  outflow,  reflect,  user, ]</td>
<td>Outer boundary condition along x3.</td>
</tr>
<tr>
<td>refinement</td>
<td>String</td>
<td>adaptive</td>
<td>[ adaptive,  static,  none, ]</td>
<td>Mesh refinement startegy.</td>
</tr>
<tr>
<td>x1max</td>
<td>Real</td>
<td>1.00000e+00</td>
<td></td>
<td>Maximum x1 value of domain.</td>
</tr>
<tr>
<td>x1min</td>
<td>Real</td>
<td>0.00000e+00</td>
<td></td>
<td>Minimum x1 value of domain.</td>
</tr>
<tr>
<td>x2max</td>
<td>Real</td>
<td>1.00000e+00</td>
<td></td>
<td>Maximum x2 value of domain.</td>
</tr>
<tr>
<td>x2min</td>
<td>Real</td>
<td>0.00000e+00</td>
<td></td>
<td>Minimum x2 value of domain.</td>
</tr>
<tr>
<td>x3max</td>
<td>Real</td>
<td>1.00000e+00</td>
<td></td>
<td>Maximum x3 value of domain.</td>
</tr>
<tr>
<td>x3min</td>
<td>Real</td>
<td>0.00000e+00</td>
<td></td>
<td>Minimum x3 value of domain.</td>
</tr>
<tr>
<td><strong>&lt;parthenon/meshblock&gt;</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>nx1</td>
<td>Integer</td>
<td>16</td>
<td></td>
<td>Size of meshblocks in x1.</td>
</tr>
<tr>
<td>nx2</td>
<td>Integer</td>
<td>16</td>
<td></td>
<td>Size of meshblocks in x2.</td>
</tr>
<tr>
<td>nx3</td>
<td>Integer</td>
<td>16</td>
<td></td>
<td>Size of meshblocks in x3.</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.indexes"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>